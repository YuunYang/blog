---
title: "å‡½æ•°æŸ¯é‡ŒåŒ–"
categories:
  - FrontTech
tags: 
  - currying
  - functional programming
entries_layout: grid
author_profile: true
toc: true
toc_label: "ç›®å½•"
toc_sticky: true
---

å‡½æ•°æŸ¯é‡ŒåŒ–æ˜¯ä¸€ç§å‡½æ•°å¼ç¼–ç¨‹çš„é«˜é˜¶æŠ€æœ¯ï¼Œå‡½æ•°æŸ¯é‡ŒåŒ–ç›¸å½“äºä¸€ä¸ªç¿»è¯‘å™¨ï¼Œå°†å½¢å¦‚f(a,b,c)çš„å‡½æ•°è°ƒç”¨è½¬åŒ–ä¸ºf(a)(b)(c)ï¼Œæˆ–è€…è½¬åŒ–å›å»ã€‚æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰ä¸ä¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè€Œåªæ˜¯è½¬åŒ–ã€‚

> ä¸‹é¢çš„ä¸¤ä¸ªğŸŒ°åŒæ ·å‡ºç°åœ¨[å¸¸è§JSä»£ç é¢˜](/fronttech/common-algorithms/#%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96)

## Talk is cheap
ğŸŒ°ä¸€

```javascript
function add() {
  var _args = [].slice.call(arguments); // line 2
  var adder = function () { // line 3
    var calculate = function() { // line 4
      [].push.apply(_args, [].slice.call(arguments)); // line 5
      return calculate;
    };
    calculate.toString = function () {
      return _args.reduce(function (a, b) {
        return a + b;
      });
    }
    return calculate;
  }
  return adder.apply(null, [].slice.call(arguments)); // line 15 
}
console.log(add(1, 2, 3, 4, 5).toString());  // 15
console.log(add(1, 2, 3, 4)(5).toString());  // 15
console.log(add(1)(2)(3)(4)(5).toString());  // 15
```

### é€è¡Œåˆ†æ
- é¦–å…ˆåœ¨ line 2 ä½ç½®ï¼Œ_args é¡¾åæ€ä¹‰å°±æ˜¯å‡½æ•°è¿è¡Œæ‰€éœ€è¦çš„å‚æ•°ï¼Œå®ƒé¦–å…ˆä¼šå­˜å‚¨ add ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶çš„å‚æ•°ä¾‹å¦‚ä¸Šé¢ä¾‹å­ä¸­åˆ†åˆ«ä¸º `1,2,3,4,5`ï¼Œ`1,2,3,4`ï¼Œ`1`ï¼›
- ç„¶åï¼Œå¯ä»¥çœ‹åˆ° line 15 è¡Œï¼Œadd è¿”å›çš„æ˜¯ adderï¼Œå¹¶ä¸”ä¼ å…¥äº†ç¬¬ä¸€æ¬¡è°ƒç”¨çš„ argumentsï¼Œå³ä¸Šè¿°çš„ï¼š`1,2,3,4,5`ï¼Œ`1,2,3,4`ï¼Œ`1`ï¼›
- æ‰€ä»¥çœ‹å› line 3 çš„ adderï¼Œadder çš„å”¯ä¸€ä½œç”¨å°±æ˜¯è¿”å›åˆæ˜¯ä¸€ä¸ªå‡½æ•° calculateï¼Œå› æ­¤æˆ‘ä»¬å…³æ³¨ calculateï¼›
- calculate é¦–å…ˆå°†å½“å‰ arguments push åˆ° _args ä¸­ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œçš„ arguments ä¸€å®šä¸æ˜¯ä¸Šé¢è¯´åˆ°çš„ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶çš„ argumentsï¼Œè§åé¢è§£é‡Šï¼‰ï¼Œç„¶åå†è¿”å›ä¸€ä¸ª calculate ä»¥ä¾›ä¸‹ä¸€æ¬¡è°ƒç”¨è®¿é—®ã€‚
- toString æ–¹æ³•åœ¨å‡½æ•°è¿è¡Œæ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œï¼ˆåº”è¯¥æ˜¯è¿™æ ·å§ï¼‰ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ¢æˆä¸€ä¸ªè‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œåæ­£å®ƒçš„ä½œç”¨æ˜¯è®¡ç®—åœ¨æœ€åæ‰€æœ‰å‚æ•°å…¨éƒ¨é›†ä¸­åˆ°ä¸€ä¸ª `_args` ä¹‹åï¼Œå¯¹å‚æ•°çš„é›†ä¸­æ“ä½œã€‚

### è§£æ
ä»¥ `console.log(add(1)(2)(3)(4)(5).toString());` ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬æœ€åä¸æ˜¾ç¤ºçš„è°ƒç”¨ `toString()`ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ‰“å°å‡ºæ¥çš„æ˜¯ä¸€ä¸ªå‡½æ•° â€”â€” `calculate`ï¼Œè¿™é‡Œçš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬å‰ä¸€ä¸ª `calculate` è¿”å›çš„ `calculate`ï¼Œè¿™é‡Œå½¢æˆäº†ä¸€ä¸ªé—­åŒ…ï¼Œå¤–éƒ¨å®šä¹‰çš„ _args å˜é‡ä¼šä¸€ç›´ä¿å­˜åœ¨ `adder` é‡Œï¼Œè¿™ä¹Ÿæ˜¯èƒ½å¤ŸæŠŠåé¢æ¯ä¸€æ¬¡è°ƒç”¨éƒ½ç»Ÿä¸€èµ·æ¥çš„åŸå› ã€‚

### ä¼˜åŒ–
ä¸Šé¢çš„ä»£ç å¯ä»¥æ›´ç®€æ´å—ï¼Ÿå¯ä»¥
```javascript
function add() {
  var _args = [];
  var adder = function () {
    [].push.apply(_args, [].slice.call(arguments));
    return adder;
  }
  adder.toString = function () {
    return _args.reduce(function (a, b) {
      return a + b;
    });
  }
  return adder.apply(null, [].slice.call(arguments));
}
console.log(add(1, 2, 3, 4, 5).toString());  // 15
console.log(add(1, 2, 3, 4)(5).toString());  // 15
console.log(add(1)(2)(3)(4)(5).toString());  // 15
```
å‰é¢è¯´è¿‡ï¼Œjs æŸ¯é‡ŒåŒ–çš„ç²¾é«“å°±åœ¨å¦‚ä½•å°†åç»­çš„å‚æ•°è¿½åŠ åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œè€Œä¹Ÿè¯´è¿‡ï¼Œé—­åŒ…å­˜åœ¨äº `adder` ä¸­ï¼Œæ‰€ä»¥è‡ªç„¶å¯ä»¥ç›´æ¥åœ¨ `adder` ä¸­è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚

## Show me your code
ğŸŒ°äºŒ

```javascript
function curry (fn, args) {
  var length = fn.length;
  args = args || [];
  return function () {
    var _args = args.slice (0), i;
    for (i = 0; i < arguments.length; i++) {
      _args.push (arguments[i]);
    }
    if (_args.length < length) {
      return curry.call (this, fn, _args);
    } else {
      return fn.apply (this, _args);
    }
  };
}
var add = curry (function (a, b, c) {
  console.log (a + b + c);
});
add (1, 2, 3); // 6
add (1) (2, 3); // 6
add (1) (2) (3); // 6
```

### åˆ†æ
å…·ä½“çš„åŸç†ä¸å†èµ˜è¿°ï¼ŒæŸ¯é‡ŒåŒ–çš„æ€æƒ³å°±æ˜¯å‚æ•°é›†åˆèµ·æ¥ã€‚
- è¿™é‡ŒåŒæ ·æœ‰ä¸€ä¸ªé—­åŒ…ï¼Œåœ¨è¿™ä¸ªé—­åŒ…ä¸­åŒæ ·ä¿æŒç€ä¸€ä¸ªå˜é‡ `length` å’Œ `args`ï¼Œè¿™é‡Œçš„ length å°±æ˜¯å‡½æ•°çš„å‚æ•°ä¸ªæ•°ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå‚æ•°ä¸ªæ•°å°±æ˜¯3ï¼›
- è¿™é‡Œé€šè¿‡å¯¹ `_args` ä¸­è¿½åŠ æ¯ä¸€æ¬¡è°ƒç”¨çš„å‚æ•°ï¼Œå¹¶å°†å…¶ä¸å‡½æ•°é•¿åº¦ â€”â€” length åšæ¯”è¾ƒï¼Œå¾ˆå¥½ç†è§£ï¼Œå¦‚æœå‚æ•°çš„ä¸ªæ•°å·²ç»å¤§äºç­‰äºå‡½æ•°æ‰€éœ€çš„å‚æ•°ä¸ªæ•°ï¼Œé‚£ä¹ˆè‡ªç„¶ç›´æ¥è¿”å›å‡½æ•°æ‰§è¡Œå³å¯ã€‚

## ğŸŒ°å¯¹æ¯”

ä¾‹å­ä¸€ä¸­çš„ä»£ç å¯ä»¥ä¸ç”¨æŒ‡å®šå‚æ•°ä¸ªæ•°ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨æœ€åéƒ½æ˜¾ç¤ºçš„æ‰§è¡Œä¸€æ¬¡ `toString` æ–¹æ³•ã€‚è€Œä¾‹å­äºŒéœ€è¦æŒ‡å®šæ˜¯å› ä¸ºæˆ‘ä»¬åˆ›å»ºçš„ `curry` å‡½æ•°é‡Œï¼Œæœ‰åˆ¤æ–­ç›¸å…³å‚æ•°ä¸ªæ•°çš„ä»£ç ã€‚